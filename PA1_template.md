---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


```r
library(knitr)
opts_chunk$set(echo = TRUE)
```


```r
data<-read.csv("activity.csv")
```


```r
total<-with(data,tapply(steps,date,sum,na.rm=TRUE))
total<-data.frame(date=names(total),steps=total)
total$date<-as.Date(as.character(total$date))
with(total,hist(steps))
```

![](PA1_template_files/figure-html/mean total steps-1.png)<!-- -->

```r
with(total,summary(steps))
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##       0    6778   10395    9354   12811   21194
```


```r
average<-with(data,tapply(steps,interval,mean,na.rm=TRUE))
average<-data.frame(interval=names(average),steps=average)
average$interval<-as.character(average$interval)
with(average,plot(interval, steps, type="l"))
```

![](PA1_template_files/figure-html/average daily activity pattern-1.png)<!-- -->

```r
with(average,tapply(steps,interval,max))
```

```
##           0          10         100        1000        1005        1010 
##   1.7169811   0.1320755   0.3207547  40.5660377  26.9811321  42.4150943 
##        1015        1020        1025        1030        1035        1040 
##  52.6603774  38.9245283  50.7924528  44.2830189  37.4150943  34.6981132 
##        1045         105        1050        1055         110        1100 
##  28.3396226   0.6792453  25.0943396  31.9433962   0.1509434  31.3584906 
##        1105        1110        1115        1120        1125        1130 
##  29.6792453  21.3207547  25.5471698  28.3773585  26.4716981  33.4339623 
##        1135        1140        1145         115        1150        1155 
##  49.9811321  42.0377358  44.6037736   0.3396226  46.0377358  59.1886792 
##         120        1200        1205        1210        1215        1220 
##   0.0000000  63.8679245  87.6981132  94.8490566  92.7735849  63.3962264 
##        1225        1230        1235        1240        1245         125 
##  50.1698113  54.4716981  32.4150943  26.5283019  37.7358491   1.1132075 
##        1250        1255         130        1300        1305        1310 
##  45.0566038  67.2830189   1.8301887  42.3396226  39.8867925  43.2641509 
##        1315        1320        1325        1330        1335        1340 
##  40.9811321  46.2452830  56.4339623  42.7547170  25.1320755  39.9622642 
##        1345         135        1350        1355         140        1400 
##  53.5471698   0.1698113  47.3207547  60.8113208   0.1698113  55.7547170 
##        1405        1410        1415        1420        1425        1430 
##  51.9622642  43.5849057  48.6981132  35.4716981  37.5471698  41.8490566 
##        1435        1440        1445         145        1450        1455 
##  27.5094340  17.1132075  26.0754717   0.3773585  43.6226415  43.7735849 
##          15         150        1500        1505        1510        1515 
##   0.1509434   0.2641509  30.0188679  36.0754717  35.4905660  38.8490566 
##        1520        1525        1530        1535        1540        1545 
##  45.9622642  47.7547170  48.1320755  65.3207547  82.9056604  98.6603774 
##         155        1550        1555        1600        1605        1610 
##   0.0000000 102.1132075  83.9622642  62.1320755  64.1320755  74.5471698 
##        1615        1620        1625        1630        1635        1640 
##  63.1698113  56.9056604  59.7735849  43.8679245  38.5660377  44.6603774 
##        1645        1650        1655        1700        1705        1710 
##  45.4528302  46.2075472  43.6792453  46.6226415  56.3018868  50.7169811 
##        1715        1720        1725        1730        1735        1740 
##  61.2264151  72.7169811  78.9433962  68.9433962  59.6603774  75.0943396 
##        1745        1750        1755        1800        1805        1810 
##  56.5094340  34.7735849  37.4528302  40.6792453  58.0188679  74.6981132 
##        1815        1820        1825        1830        1835        1840 
##  85.3207547  59.2641509  67.7735849  77.6981132  74.2452830  85.3396226 
##        1845        1850        1855        1900        1905        1910 
##  99.4528302  86.5849057  85.6037736  84.8679245  77.8301887  58.0377358 
##        1915        1920        1925        1930        1935        1940 
##  53.3584906  36.3207547  20.7169811  27.3962264  40.0188679  30.2075472 
##        1945        1950        1955          20         200        2000 
##  25.5471698  45.6603774  33.5283019   0.0754717   0.0000000  19.6226415 
##        2005        2010        2015        2020        2025        2030 
##  19.0188679  19.3396226  33.3396226  26.8113208  21.1698113  27.3018868 
##        2035        2040        2045         205        2050        2055 
##  21.3396226  19.5471698  21.3207547   0.0000000  32.3018868  20.1509434 
##         210        2100        2105        2110        2115        2120 
##   1.1320755  15.9433962  17.2264151  23.4528302  19.2452830  12.4528302 
##        2125        2130        2135        2140        2145         215 
##   8.0188679  14.6603774  16.3018868   8.6792453   7.7924528   0.0000000 
##        2150        2155         220        2200        2205        2210 
##   8.1320755   2.6226415   0.0000000   1.4528302   3.6792453   4.8113208 
##        2215        2220        2225        2230        2235        2240 
##   8.5094340   7.0754717   8.6981132   9.7547170   2.2075472   0.3207547 
##        2245         225        2250        2255         230        2300 
##   0.1132075   0.1320755   1.6037736   4.6037736   0.0000000   3.3018868 
##        2305        2310        2315        2320        2325        2330 
##   2.8490566   0.0000000   0.8301887   0.9622642   1.5849057   2.6037736 
##        2335        2340        2345         235        2350        2355 
##   4.6981132   3.3018868   0.6415094   0.2264151   0.2264151   1.0754717 
##         240         245          25         250         255          30 
##   0.0000000   0.0000000   2.0943396   1.5471698   0.9433962   0.5283019 
##         300         305         310         315         320         325 
##   0.0000000   0.0000000   0.0000000   0.0000000   0.2075472   0.6226415 
##         330         335         340         345          35         350 
##   1.6226415   0.5849057   0.4905660   0.0754717   0.8679245   0.0000000 
##         355          40         400         405         410         415 
##   0.0000000   0.0000000   1.1886792   0.9433962   2.5660377   0.0000000 
##         420         425         430         435         440         445 
##   0.3396226   0.3584906   4.1132075   0.6603774   3.4905660   0.8301887 
##          45         450         455           5          50         500 
##   1.4716981   3.1132075   1.1132075   0.3396226   0.3018868   0.0000000 
##         505         510         515         520         525         530 
##   1.5660377   3.0000000   2.2452830   3.3207547   2.9622642   2.0943396 
##         535         540         545          55         550         555 
##   6.0566038  16.0188679  18.3396226   0.1320755  39.4528302  44.4905660 
##         600         605         610         615         620         625 
##  31.4905660  49.2641509  53.7735849  63.4528302  49.9622642  47.0754717 
##         630         635         640         645         650         655 
##  52.1509434  39.3396226  44.0188679  44.1698113  37.3584906  49.0377358 
##         700         705         710         715         720         725 
##  43.8113208  44.3773585  50.5094340  54.5094340  49.9245283  50.9811321 
##         730         735         740         745         750         755 
##  55.6792453  44.3207547  52.2641509  69.5471698  57.8490566  56.1509434 
##         800         805         810         815         820         825 
##  73.3773585  68.2075472 129.4339623 157.5283019 171.1509434 155.3962264 
##         830         835         840         845         850         855 
## 177.3018868 206.1698113 195.9245283 179.5660377 183.3962264 167.0188679 
##         900         905         910         915         920         925 
## 143.4528302 124.0377358 109.1132075 108.1132075 103.7169811  95.9622642 
##         930         935         940         945         950         955 
##  66.2075472  45.2264151  24.7924528  38.7547170  34.9811321  21.0566038
```

```r
average[which.max(average$steps),]
```

```
##     interval    steps
## 835      835 206.1698
```


```r
sum(is.na(data))
```

```
## [1] 2304
```

```r
library(plyr)
library(dplyr)
```

```
## 
## Attaching package: 'dplyr'
```

```
## The following objects are masked from 'package:plyr':
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize
```

```
## The following objects are masked from 'package:stats':
## 
##     filter, lag
```

```
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```

```r
data_comp<-join(data,average, type="left",by="interval")
names(data_comp)<-c("steps","date","interval","avg_steps")
data_comp$steps<-as.double(data_comp$steps)
data_comp<-data_comp %>% mutate(steps = if_else(is.na(steps), avg_steps, steps))
data_comp$avg_steps<-NULL

total_comp<-with(data_comp,tapply(steps,date,sum,na.rm=TRUE))
total_comp<-data.frame(date=names(total_comp),steps=total_comp)
total_comp$date<-as.Date(as.character(total_comp$date))
with(total_comp,hist(steps))
```

![](PA1_template_files/figure-html/imputing missing values-1.png)<!-- -->

```r
with(total_comp,summary(steps))
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##      41    9819   10766   10766   12811   21194
```


```r
data_comp$weekday<-weekdays(as.Date(data_comp$date))
data_comp<-data_comp %>% mutate(weekday = if_else(weekday %in% c("Saturday","Sunday"), "weekend", "weekday"))
data_comp$weekday<-as.factor(data_comp$weekday)
avg_comp<-with(data_comp,tapply(steps,weekday,mean,na.rm=TRUE))
avg_comp<-data.frame(weekday=names(avg_comp),steps=avg_comp)

avg<-data_comp %>% group_by(weekday,interval) %>% summarize(avg_steps=mean(steps))
library(ggplot2)
g<-ggplot(avg,aes(interval,avg_steps))
g+geom_line()+facet_grid(weekday~.)+xlab("interval")+ylab("Number of steps")
```

![](PA1_template_files/figure-html/weekday-1.png)<!-- -->

